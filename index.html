<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>â³ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø²Ù…Ù† â€“ it</title>

<style>
body {
  background:#000;
  color:#0f0;
  font-family: monospace;
  text-align:center;
  padding-top:50px;
}
#time {
  font-size:48px;
  margin:20px;
}
#msg {
  font-size:26px;
  color:#0ff;
  margin-top:20px;
}
input, button {
  font-size:18px;
  padding:6px;
  margin:5px;
}
</style>
</head>

<body>

<h1>â³ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø²Ù…Ù†</h1>
<div id="time">--:--:--</div>
<div id="msg"></div>

<hr style="width:60%;margin:30px auto">

<h3>ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø²Ù…Ù† Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ</h3>
<input type="number" id="offset" placeholder="Ø¯Ù‚Ø§Ø¦Ù‚ (+ / -)">
<button onclick="setOffset()">ØªØ·Ø¨ÙŠÙ‚</button>

<!-- Firebase CDN -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

<script>
/* ğŸ” Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase (Ù…Ù† Ø¹Ù†Ø¯Ùƒ) */
const firebaseConfig = {
  apiKey: "AIzaSyD4XkZaqv7_c-uiUFc2NvZEFyQUapirz-Y",
  authDomain: "setouchi-it.firebaseapp.com",
  databaseURL: "https://setouchi-it-default-rtdb.firebaseio.com",
  projectId: "setouchi-it",
  storageBucket: "setouchi-it.firebasestorage.app",
  messagingSenderId: "456612217542",
  appId: "1:456612217542:web:51d963523b1306e0bf4dc7"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const timeRef = db.ref("it_time");

/* Ù‚ÙŠÙ… Ø§ÙØªØ±Ø§Ø¶ÙŠØ© */
let offsetMinutes = 0;
let message = "Ù„Ù‚Ø¯ Ù†Ø¬Ø­Øª ÙŠØ§ Ø²ÙŠØ§Ø¯";

/* Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø²Ù…Ù† Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ */
timeRef.on("value", snap => {
  if (!snap.exists()) return;
  const data = snap.val();
  offsetMinutes = data.offsetMinutes || 0;
  message = data.message || "";
});

/* ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø§Ø¹Ø© */
function updateClock(){
  const now = new Date();
  const adjusted = new Date(now.getTime() + offsetMinutes * 60000);

  const h = adjusted.getHours().toString().padStart(2,'0');
  const m = adjusted.getMinutes().toString().padStart(2,'0');
  const s = adjusted.getSeconds().toString().padStart(2,'0');

  document.getElementById("time").textContent = `${h}:${m}:${s}`;

  if(h==="03" && m==="00"){
    document.getElementById("msg").textContent = message;
  } else {
    document.getElementById("msg").textContent = "";
  }
}

setInterval(updateClock, 1000);
updateClock();

/* ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø²Ù…Ù† */
function setOffset(){
  const val = Number(document.getElementById("offset").value);
  timeRef.set({
    offsetMinutes: val,
    message: "Ù„Ù‚Ø¯ Ù†Ø¬Ø­Øª ÙŠØ§ Ø²ÙŠØ§Ø¯"
  });
}
</script>

</body>
</html>
